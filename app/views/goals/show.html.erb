<div class="goal-show-container">
  <h1><%= @goal.name %></h1>
  <h2>ðŸŽ– Trophy Ã  dÃ©bloquer</h2>
</div>

<!-- Progression -->
<div class="progress-container">
  <% total = @goal.badges.count %>
  <% done = @validated_badges.count { |id| @goal.badges.pluck(:id).include?(id) } %>
  <% percent = total.zero? ? 0 : ((done.to_f / total) * 100).round %>

  <div class="progress-bar" style="width: <%= percent %>%"></div>
  <div class="progress-text"><%= percent %>%</div>
</div>

<div class="trophy-list">
  <% @badges.each do |badge| %>
    <div class="trophy-card">
      <div class="trophy-card-text">
        <h3><%= badge.title %></h3>

        <p><%= badge.description %></p>
      </div>

      <div class="trophy-card-action">
        <% if @validated_badges.include?(badge.id) %>
          <span class="validated">âœ”</span>
        <% else %>
          <%= button_to "ðŸ†",
                user_badges_path(badge_id: badge.id),
                method: :post,
                class: "validate-btn" %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<%= link_to "â¬…ï¸ Retour au dashboard", dashboard_path, class: "btn btn-secondary mt-3" %>
